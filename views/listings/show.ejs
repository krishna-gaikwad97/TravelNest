<!-- <% layout("/layouts/boilerplate.ejs") %>
  <body>
    <div class="row">
      <div class="col-8 offset-2">
     <h3>Listing Details :</h3>
    </div>
    <div class="card col-6 ">
      <img src="<%=listing.image%>" class="card-img-top show-img" alt="Listing image">
  <div class="card-body">
    <p class="card-text"><%= listing.title %></p>
  </div>
    </div>
    <ul>
      <li><%= listing.description %></li>
      <li>&#8377; <%= listing.price.toLocaleString("en-IN") %></li>
      <li><%= listing.location %></li>
      <li><%= listing.country %></li>
    </ul>
    <br />
    <a href="/listings/<%= listing._id %>/edit">Edit this Listing</a>
    <br /><br />
    <form method="POST" action="/listings/<%=listing._id%>?_method=DELETE">
      <button>Delete this listing</button>
    </form>
      </div>
   
  </body> -->
<% layout("/layouts/boilerplate.ejs") %>
<body>
  <div class="container mt-5">
    <div class="row justify-content-center">
      <div class="col-8 text-center">
        <h3 class="mb-4"><%= listing.title %></h3>
        
         <div class="card mb-4 ">
          <img src="<%= listing.image %>" class="card-img-top img-fluid" alt="Listing image" style="max-height: 300px; object-fit: cover;"> 
          <div class="card-body">
            

            <!-- <h5 class="card-title"><%= listing.title %></h5> -->
            <ul class="list-group list-group-flush text-start mt-3">
              <li class="list-group-item"><strong>Description:</strong> <%= listing.description %></li>
              
        <li class="list-group-item"><strong>Price:</strong> 
  
  &#8377; <%= listing.price ? Number(listing.price).toLocaleString("en-IN") : "N/A" %>
</li>

              <li class="list-group-item"><strong>Location:</strong> <%= listing.location %></li>
              <li class="list-group-item"><strong>Country:</strong> <%= listing.country %></li>
            </ul>
          </div>
        </div>

        <div class="d-flex justify-content-center gap-3">
          <a href="/listings/<%= listing._id %>/edit" class="btn btn-danger" >Edit</a>
          
          <form method="POST" action="/listings/<%= listing._id %>?_method=DELETE" style="display: inline;">
            <button type="submit" class="btn btn-dark ">Delete</button>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="col-8 offset-3">
    <hr>
   
    <h4>Leave a Review</h4>
    <form action="/listings/<%= listing._id %>/reviews" method="POST" class="mb-5 needs-validation" novalidate >
      <div>
        <label for="rating" class="form-label">Your Rating</label>
        <input type="range" min="1" max="5" step="1" id="rating" name="review[rating]" class="form-range"  >
      </div>
      <div>
        <label for="comment" class="form-label">Your Comment</label>
        <textarea id="comment" name="review[comment]" rows="5" cols="30" class="form-control" required></textarea>
        <div class="invalid-feedback">Please give your valid-feedback</div>
      </div>
      <button type="submit" class="btn btn-outline-dark">Submit Review</button>
    </form>
    <hr>
    <h4>Reviews</h4>
    <% if(listing.reviews.length===0){ %>
      <p>No reviews yet. Be the first to review!</p>
    <% } else { %>
      <% for(let rev of listing.reviews) { %>
        <div class="card mb-3">
          <div class="card-body">
            <h5 class="card-title">Rating: <%= rev.rating %> / 5</h5>
            <p class="card-text"><%= rev.Comment %></p>
          </div>
        </div>    
         <form class="mb-3" method="post" action="/listings/<%=listing._id%>/reviews/<%=rev._id%> ?_method=DELETE">
    <button class="btn btn-sm btn-dark">Delete</button>
  </form>       
      <% } %>
    <% } %>
  </div>
 
  <script src="/js/script.js"></script>
</body>
